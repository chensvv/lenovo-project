webpackJsonp([62],{WlZD:function(e,t){},lGRM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),i=r.n(a),s=r("iGF/"),n=r("PXCl").Base64,o={inject:["reload"],data:function(){return{list:[],defaultProps:{children:"children",label:"ruleName"},addList:{parentCode:"",ruleCode:"",ruleName:"",url:"",icon:""},currentItem:{id:"",ruleCode:"",ruleName:"",url:"",icon:""},addRules:{ruleName:[{required:!0,message:"请输入权限名称",trigger:"change"}],ruleCode:[{required:!0,message:"请输入权限标识",trigger:"change"}],url:[{required:!0,message:"请输入url",trigger:"change"}]},editRules:{ruleName:[{required:!0,message:"请输入权限名称",trigger:"change"}],ruleCode:[{required:!0,message:"请输入权限标识",trigger:"change"}],url:[{required:!0,message:"请输入url",trigger:"change"}]},listLoading:!1,editVisible:!1,addVisible:!1,addBtnLoading:!1,editBtnLoading:!1,ruleCodeAuth:!1,urlAuth:!1,addTitle:""}},created:function(){this.getList()},methods:{openFun:function(e){var t=this;this.$nextTick(function(){t.$refs[e]&&t.$refs[e].resetFields()})},closeFun:function(e){var t=this;this.$nextTick(function(){t.$refs[e]&&t.$refs[e].clearValidate()})},editHandleClose:function(){this.editVisible=!1},addHandleClose:function(){this.addVisible=!1},handleAdd:function(e){this.addList={parentCode:0==e?0:e.id,ruleCode:"",ruleName:"",url:"",icon:0==e?"el-icon-tickets":3==e.menutype?" ":"el-icon-document"},0==e?(this.ruleCodeAuth=!1,this.urlAuth=!1,this.addTitle="新增一级菜单权限"):1==e.menutype?(this.urlAuth=!0,this.ruleCodeAuth=!0,this.addTitle="新增字菜单权限"):(this.urlAuth=!1,this.ruleCodeAuth=!0,this.addTitle="新增按钮权限"),this.addVisible=!0},addHandleConfirm:function(e){var t=this,r={parentCode:this.addList.parentCode,ruleCode:this.addList.ruleCode,ruleName:this.addList.ruleName,url:this.addList.url,icon:this.addList.icon},a={userName:sessionStorage.getItem("username"),password:n.decode(sessionStorage.getItem("log"))};this.$refs[e].validate(function(e){if(!e)return!1;t.addBtnLoading=!0,Object(s.g)(r).then(function(e){t.addBtnLoading=!1,200==e.data.code?(t.$message({message:"添加成功",type:"success",duration:1e3}),t.getList(),t.addVisible=!1,sessionStorage.removeItem("menuData"),sessionStorage.removeItem("btnpermission"),Object(s.k)(a).then(function(e){200==e.data.code?(sessionStorage.setItem("menuData",i()(e.data.data)),t.reload()):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})})):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})}).catch(function(e){t.editBtnLoading=!1})})},handleEdit:function(e){console.log(e),this.currentItem={id:e.id,ruleCode:e.ruleCode,ruleName:e.ruleName,url:e.url,icon:e.icon},1==e.menutype?(this.ruleCodeAuth=!1,this.urlAuth=!1):2==e.menutype?(this.urlAuth=!0,this.ruleCodeAuth=!0):(this.urlAuth=!1,this.ruleCodeAuth=!0),this.editVisible=!0},editHandleConfirm:function(e){var t=this,r={id:this.currentItem.id,ruleCode:this.currentItem.ruleCode,ruleName:this.currentItem.ruleName,url:this.currentItem.url,icon:this.currentItem.icon},a={userName:sessionStorage.getItem("username"),password:n.decode(sessionStorage.getItem("log"))};this.$refs[e].validate(function(e){if(!e)return!1;t.editBtnLoading=!0,Object(s.j)(r).then(function(e){t.editBtnLoading=!1,200==e.data.code?(t.$message({message:"编辑成功",type:"success",duration:1e3}),t.getList(),t.editVisible=!1,sessionStorage.removeItem("menuData"),sessionStorage.removeItem("btnpermission"),Object(s.k)(a).then(function(e){200==e.data.code?(sessionStorage.setItem("menuData",i()(e.data.data)),t.reload()):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})})):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})}).catch(function(e){t.editBtnLoading=!1})})},handleDel:function(e){var t=this,r={id:e},a={userName:sessionStorage.getItem("username"),password:n.decode(sessionStorage.getItem("log"))};this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.h)(r).then(function(e){200==e.data.code?(t.$message({message:"删除成功",type:"success",duration:1e3}),t.getList(),sessionStorage.removeItem("menuData"),sessionStorage.removeItem("btnpermission"),Object(s.k)(a).then(function(e){200==e.data.code?(sessionStorage.setItem("menuData",i()(e.data.data)),t.reload()):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})})):t.$message({message:e.data.errorMessage,type:"error",duration:1e3})})}).catch(function(e){console.log(e)})},getList:function(){var e=this;this.listLoading=!0,Object(s.i)().then(function(t){console.log(t),e.listLoading=!1,e.list=t.data})}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table tree"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),e._l(e.$route.meta,function(t,a){return r("el-breadcrumb-item",{key:a},[e._v(e._s(t))])})],2),e._v(" "),r("el-form",{ref:"searchItem",staticClass:"demo-form-inline cache",attrs:{inline:!0,model:e.searchItem,size:"mini"}},[r("el-form-item",{staticClass:"sub-btn"},[r("el-button",{directives:[{name:"has",rawName:"v-has",value:"Rule:add",expression:"'Rule:add'"}],attrs:{type:"primary",size:"mini",loading:e.btnLoading},on:{click:function(t){return e.handleAdd(0)}}},[e._v("增加一级权限")])],1)],1),e._v(" "),r("el-tree",{attrs:{props:e.defaultProps,data:e.list,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1,laoding:e.listLoading},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,i=t.data;return r("span",{staticClass:"custom-tree-node"},[r("span",[e._v(e._s(a.label))]),e._v(" "),r("span",[3!=i.menutype?r("el-button",{directives:[{name:"has",rawName:"v-has",value:"Rule:add",expression:"'Rule:add'"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleAdd(i)}}},[e._v("增加")]):e._e(),e._v(" "),r("el-button",{directives:[{name:"has",rawName:"v-has",value:"Rule:update",expression:"'Rule:update'"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleEdit(i)}}},[e._v("编辑")]),e._v(" "),r("el-button",{directives:[{name:"has",rawName:"v-has",value:"Rule:delete",expression:"'Rule:delete'"}],attrs:{type:"text",size:"mini"},on:{click:function(){return e.handleDel(i.id)}}},[e._v("删除")])],1)])}}])}),e._v(" "),r("el-dialog",{attrs:{title:e.addTitle,visible:e.addVisible,width:"300","before-close":e.addHandleClose},on:{"update:visible":function(t){e.addVisible=t},open:function(t){return e.openFun("addList")}}},[r("el-form",{ref:"addList",attrs:{"label-position":"right","label-width":"120px",size:"small",rules:e.addRules,model:e.addList}},[r("el-form-item",{attrs:{label:"权限名称",prop:"ruleName"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.addList.ruleName,callback:function(t){e.$set(e.addList,"ruleName","string"==typeof t?t.trim():t)},expression:"addList.ruleName"}})],1),e._v(" "),e.ruleCodeAuth?r("el-form-item",{attrs:{label:"权限标识",prop:"ruleCode"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.addList.ruleCode,callback:function(t){e.$set(e.addList,"ruleCode","string"==typeof t?t.trim():t)},expression:"addList.ruleCode"}})],1):e._e(),e._v(" "),e.urlAuth?r("el-form-item",{attrs:{label:"url",prop:"url"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.addList.url,callback:function(t){e.$set(e.addList,"url","string"==typeof t?t.trim():t)},expression:"addList.url"}})],1):e._e()],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.addHandleClose}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.addBtnLoading},on:{click:function(t){return e.addHandleConfirm("addList")}}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"300","before-close":e.editHandleClose},on:{"update:visible":function(t){e.editVisible=t},close:function(t){return e.closeFun("currentItem")}}},[r("el-form",{ref:"currentItem",attrs:{"label-position":"right","label-width":"120px",size:"small",rules:e.editRules,model:e.currentItem}},[r("el-form-item",{attrs:{label:"权限名称",prop:"ruleName"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.currentItem.ruleName,callback:function(t){e.$set(e.currentItem,"ruleName","string"==typeof t?t.trim():t)},expression:"currentItem.ruleName"}})],1),e._v(" "),e.ruleCodeAuth?r("el-form-item",{attrs:{label:"权限标识",prop:"ruleCode"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.currentItem.ruleCode,callback:function(t){e.$set(e.currentItem,"ruleCode","string"==typeof t?t.trim():t)},expression:"currentItem.ruleCode"}})],1):e._e(),e._v(" "),e.urlAuth?r("el-form-item",{attrs:{label:"url",prop:"url"}},[r("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.currentItem.url,callback:function(t){e.$set(e.currentItem,"url","string"==typeof t?t.trim():t)},expression:"currentItem.url"}})],1):e._e()],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.editHandleClose}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.editBtnLoading},on:{click:function(t){return e.editHandleConfirm("currentItem")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(o,l,!1,function(e){r("WlZD")},null,null);t.default=d.exports}});